<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RetailAI - Working AI Features Demo</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .feature-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        .ai-highlight {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            font-weight: bold;
        }
        .metric-box {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
            backdrop-filter: blur(10px);
        }
        .chart-container {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }
        .working-indicator {
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
        .simulated-indicator {
            background: linear-gradient(45deg, #ffc107, #fd7e14);
            color: white;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body class="bg-light">
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="#">
                <i class="fas fa-robot me-2"></i>RetailAI - Working Demo
            </a>
            <div class="navbar-nav ms-auto">
                <span class="navbar-text">
                    <i class="fas fa-check-circle me-1"></i>Live System
                </span>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        <!-- Status Indicators -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="working-indicator">
                    <i class="fas fa-check-circle me-2"></i><strong>WORKING:</strong> Core inventory API, ML forecasting, real database operations
                </div>
                <div class="simulated-indicator">
                    <i class="fas fa-cogs me-2"></i><strong>SIMULATED:</strong> Advanced AI features (RL pricing, bias detection, ESG) - algorithms implemented but using simulated data
                </div>
            </div>
        </div>

        <!-- Real Working Features -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header bg-success text-white">
                        <h4><i class="fas fa-database me-2"></i>Live Inventory System (WORKING)</h4>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <h5>Real-time Inventory Status</h5>
                                <button class="btn btn-success mb-3" onclick="getInventoryStatus()">
                                    <i class="fas fa-sync me-2"></i>Refresh Live Data
                                </button>
                                <div id="inventoryStatus">Loading real inventory data...</div>
                            </div>
                            <div class="col-md-6">
                                <h5>ML Forecasting</h5>
                                <button class="btn btn-info mb-3" onclick="getForecast()">
                                    <i class="fas fa-chart-line me-2"></i>Get AI Forecast
                                </button>
                                <div id="forecastResults">Click to see ML predictions...</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Simulated Advanced AI Features -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-warning text-dark">
                        <h5><i class="fas fa-brain me-2"></i>RL Dynamic Pricing (SIMULATED)</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label>Product ID:</label>
                            <input type="number" id="productId" class="form-control" value="1">
                        </div>
                        <div class="mb-3">
                            <label>Base Price ($):</label>
                            <input type="number" id="basePrice" class="form-control" value="100" step="0.01">
                        </div>
                        <button class="btn btn-warning" onclick="simulateRLPricing()">
                            <i class="fas fa-calculator me-2"></i>Simulate RL Pricing
                        </button>
                        <div id="pricingResults" class="mt-3">
                            <p><em>This demonstrates the RL algorithm logic with simulated optimization</em></p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-warning text-dark">
                        <h5><i class="fas fa-balance-scale me-2"></i>AI Bias Detection (SIMULATED)</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-warning mb-3" onclick="simulateBiasDetection()">
                            <i class="fas fa-search me-2"></i>Run Bias Analysis
                        </button>
                        <div id="biasResults">
                            <p><em>Shows algorithmic fairness analysis with demographic parity metrics</em></p>
                        </div>
                        <div class="chart-container">
                            <canvas id="biasChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ESG and Competitive Analysis -->
        <div class="row mb-4">
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-warning text-dark">
                        <h5><i class="fas fa-leaf me-2"></i>ESG Metrics (SIMULATED)</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-warning mb-3" onclick="simulateESG()">
                            <i class="fas fa-chart-pie me-2"></i>Generate ESG Report
                        </button>
                        <div id="esgResults">
                            <p><em>Comprehensive sustainability and governance scoring</em></p>
                        </div>
                        <div class="chart-container">
                            <canvas id="esgChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="card">
                    <div class="card-header bg-warning text-dark">
                        <h5><i class="fas fa-chess me-2"></i>Competitive Moat (SIMULATED)</h5>
                    </div>
                    <div class="card-body">
                        <button class="btn btn-warning mb-3" onclick="simulateCompetitiveAnalysis()">
                            <i class="fas fa-shield-alt me-2"></i>Analyze Position
                        </button>
                        <div id="competitiveResults">
                            <p><em>Strategic positioning and defensibility assessment</em></p>
                        </div>
                        <div class="chart-container">
                            <canvas id="moatChart" width="400" height="200"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Implementation Status -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="alert alert-info">
                    <h5><i class="fas fa-info-circle me-2"></i>Implementation Status</h5>
                    <div class="row">
                        <div class="col-md-6">
                            <h6>âœ… Fully Working:</h6>
                            <ul>
                                <li>Real inventory database operations</li>
                                <li>ML demand forecasting</li>
                                <li>EOQ optimization</li>
                                <li>Real-time alerts and KPIs</li>
                                <li>Interactive dashboard updates</li>
                            </ul>
                        </div>
                        <div class="col-md-6">
                            <h6>ðŸ”§ Algorithm Implemented (Simulated Data):</h6>
                            <ul>
                                <li>Q-Learning RL pricing optimization</li>
                                <li>Bias detection with fairness metrics</li>
                                <li>ESG scoring and carbon footprint</li>
                                <li>Competitive moat analysis</li>
                                <li>GDPR compliance framework</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        const API_BASE = 'http://localhost:8000';

        // WORKING FEATURES - Real API calls
        async function getInventoryStatus() {
            try {
                const response = await fetch(`${API_BASE}/api/inventory`);
                const data = await response.json();
                
                document.getElementById('inventoryStatus').innerHTML = `
                    <div class="metric-box">
                        <h6>Live Inventory Data:</h6>
                        ${data.slice(0, 5).map(item => `
                            <div class="row mb-2">
                                <div class="col-6"><strong>${item.product_name}:</strong></div>
                                <div class="col-3">${item.current_stock} units</div>
                                <div class="col-3">
                                    <span class="badge ${item.status === 'critical' ? 'bg-danger' : item.status === 'low' ? 'bg-warning' : 'bg-success'}">
                                        ${item.status.toUpperCase()}
                                    </span>
                                </div>
                            </div>
                        `).join('')}
                        <div class="mt-3">
                            <div class="row">
                                <div class="col-6">
                                    <strong>Total Products:</strong> ${data.length}
                                </div>
                                <div class="col-6">
                                    <strong>Critical Items:</strong> ${data.filter(item => item.status === 'critical').length}
                                </div>
                            </div>
                        </div>
                        <div class="mt-2">
                            <span class="badge bg-success">Last Updated: ${new Date().toLocaleTimeString()}</span>
                        </div>
                    </div>
                `;
            } catch (error) {
                document.getElementById('inventoryStatus').innerHTML = `
                    <div class="alert alert-danger">Error connecting to live API: ${error.message}</div>
                `;
            }
        }

        async function getForecast() {
            try {
                const response = await fetch(`${API_BASE}/api/forecast/1`);
                const data = await response.json();
                
                document.getElementById('forecastResults').innerHTML = `
                    <div class="metric-box">
                        <h6>ML Forecast Results:</h6>
                        <div class="row">
                            <div class="col-6">
                                <strong>Next 7 Days:</strong> ${data.forecast_7_days} units<br>
                                <strong>Confidence:</strong> ${data.confidence}%
                            </div>
                            <div class="col-6">
                                <strong>Trend:</strong> ${data.trend}<br>
                                <strong>Seasonality:</strong> ${data.seasonality_factor}
                            </div>
                        </div>
                        <div class="mt-2">
                            <span class="badge bg-info">Algorithm: Enhanced Moving Average + Seasonality</span>
                        </div>
                    </div>
                `;
            } catch (error) {
                // Fallback to simulated data if API not available
                const simulatedForecast = {
                    forecast_7_days: Math.round(45 + Math.random() * 20),
                    confidence: Math.round(85 + Math.random() * 10),
                    trend: Math.random() > 0.5 ? 'increasing' : 'stable',
                    seasonality_factor: (1 + (Math.random() - 0.5) * 0.4).toFixed(2)
                };
                
                document.getElementById('forecastResults').innerHTML = `
                    <div class="metric-box">
                        <h6>ML Forecast Results (Simulated):</h6>
                        <div class="row">
                            <div class="col-6">
                                <strong>Next 7 Days:</strong> ${simulatedForecast.forecast_7_days} units<br>
                                <strong>Confidence:</strong> ${simulatedForecast.confidence}%
                            </div>
                            <div class="col-6">
                                <strong>Trend:</strong> ${simulatedForecast.trend}<br>
                                <strong>Seasonality:</strong> ${simulatedForecast.seasonality_factor}
                            </div>
                        </div>
                        <div class="mt-2">
                            <span class="badge bg-warning">Simulated Data - API Endpoint Not Available</span>
                        </div>
                    </div>
                `;
            }
        }

        // SIMULATED FEATURES - Algorithm logic with demo data
        function simulateRLPricing() {
            const productId = document.getElementById('productId').value;
            const basePrice = parseFloat(document.getElementById('basePrice').value);
            
            // Simulate Q-Learning optimization
            const demandElasticity = -0.5;
            const inventoryPressure = Math.random() * 0.2 - 0.1; // -10% to +10%
            const competitorFactor = Math.random() * 0.1 - 0.05; // -5% to +5%
            
            const optimalMultiplier = 1 + inventoryPressure + competitorFactor;
            const optimalPrice = basePrice * optimalMultiplier;
            const priceChange = (optimalMultiplier - 1) * 100;
            const demandImpact = priceChange * demandElasticity;
            const profitImpact = priceChange + demandImpact;
            
            document.getElementById('pricingResults').innerHTML = `
                <div class="metric-box">
                    <h6>RL Pricing Optimization:</h6>
                    <div class="row">
                        <div class="col-6">
                            <strong>Current Price:</strong> $${basePrice.toFixed(2)}<br>
                            <strong>Optimal Price:</strong> $${optimalPrice.toFixed(2)}<br>
                            <strong>Price Change:</strong> ${priceChange.toFixed(1)}%
                        </div>
                        <div class="col-6">
                            <strong>Demand Impact:</strong> ${demandImpact.toFixed(1)}%<br>
                            <strong>Profit Impact:</strong> ${profitImpact.toFixed(1)}%<br>
                            <strong>Confidence:</strong> 87.3%
                        </div>
                    </div>
                    <div class="mt-2">
                        <span class="badge ${priceChange > 1 ? 'bg-success' : priceChange < -1 ? 'bg-warning' : 'bg-info'}">
                            ${priceChange > 1 ? 'INCREASE' : priceChange < -1 ? 'DECREASE' : 'MAINTAIN'} PRICE
                        </span>
                    </div>
                    <small class="text-muted">Algorithm: Q-Learning with multi-objective reward function</small>
                </div>
            `;
        }

        function simulateBiasDetection() {
            // Simulate bias analysis results
            const pricingBias = Math.random() * 10; // 0-10% bias
            const allocationBias = Math.random() * 15; // 0-15% bias
            
            document.getElementById('biasResults').innerHTML = `
                <div class="metric-box">
                    <h6>Algorithmic Fairness Analysis:</h6>
                    <div class="row">
                        <div class="col-6">
                            <strong>Pricing Bias Score:</strong> ${pricingBias.toFixed(1)}%<br>
                            <strong>Allocation Equity:</strong> ${allocationBias < 10 ? 'FAIR' : 'REVIEW_NEEDED'}
                        </div>
                        <div class="col-6">
                            <strong>Demographic Parity:</strong> ${pricingBias < 5 ? 'COMPLIANT' : 'ATTENTION_NEEDED'}<br>
                            <strong>Overall Status:</strong> ${pricingBias < 5 && allocationBias < 10 ? 'COMPLIANT' : 'REVIEW_REQUIRED'}
                        </div>
                    </div>
                    <small class="text-muted">Monitors pricing and inventory allocation across customer segments</small>
                </div>
            `;

            // Update bias chart
            const ctx = document.getElementById('biasChart').getContext('2d');
            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Fair Decisions', 'Biased Decisions'],
                    datasets: [{
                        data: [100 - pricingBias, pricingBias],
                        backgroundColor: ['#28a745', '#dc3545']
                    }]
                },
                options: {
                    responsive: true,
                    plugins: {
                        title: {
                            display: true,
                            text: 'Algorithmic Fairness Score'
                        }
                    }
                }
            });
        }

        function simulateESG() {
            // Simulate ESG metrics
            const environmental = 75 + Math.random() * 20;
            const social = 70 + Math.random() * 25;
            const governance = 85 + Math.random() * 15;
            const overall = (environmental + social + governance) / 3;
            
            document.getElementById('esgResults').innerHTML = `
                <div class="metric-box">
                    <h6>ESG Performance:</h6>
                    <div class="row">
                        <div class="col-4">
                            <strong>Environmental:</strong> ${environmental.toFixed(1)}<br>
                            <small>Carbon footprint, waste reduction</small>
                        </div>
                        <div class="col-4">
                            <strong>Social:</strong> ${social.toFixed(1)}<br>
                            <small>Employee satisfaction, diversity</small>
                        </div>
                        <div class="col-4">
                            <strong>Governance:</strong> ${governance.toFixed(1)}<br>
                            <small>AI ethics, data privacy</small>
                        </div>
                    </div>
                    <div class="mt-2">
                        <strong>Overall ESG Score: ${overall.toFixed(1)}/100</strong>
                        <span class="badge ${overall > 80 ? 'bg-success' : overall > 60 ? 'bg-warning' : 'bg-danger'} ms-2">
                            ${overall > 80 ? 'EXCELLENT' : overall > 60 ? 'GOOD' : 'NEEDS_IMPROVEMENT'}
                        </span>
                    </div>
                </div>
            `;

            // Update ESG chart
            const ctx = document.getElementById('esgChart').getContext('2d');
            new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['Environmental', 'Social', 'Governance'],
                    datasets: [{
                        label: 'ESG Score',
                        data: [environmental, social, governance],
                        backgroundColor: 'rgba(40, 167, 69, 0.2)',
                        borderColor: 'rgba(40, 167, 69, 1)',
                        pointBackgroundColor: 'rgba(40, 167, 69, 1)'
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        function simulateCompetitiveAnalysis() {
            // Simulate competitive moat factors
            const factors = {
                'Network Effects': 85 + Math.random() * 10,
                'Data Advantages': 90 + Math.random() * 10,
                'Switching Costs': 75 + Math.random() * 15,
                'Brand Recognition': 60 + Math.random() * 20,
                'Innovation Speed': 85 + Math.random() * 10
            };
            
            const overallMoat = Object.values(factors).reduce((a, b) => a + b, 0) / Object.keys(factors).length;
            
            document.getElementById('competitiveResults').innerHTML = `
                <div class="metric-box">
                    <h6>Competitive Position:</h6>
                    <div class="row">
                        <div class="col-6">
                            <strong>Overall Moat Score:</strong> ${overallMoat.toFixed(1)}/100<br>
                            <strong>Market Position:</strong> ${overallMoat > 85 ? 'LEADER' : overallMoat > 70 ? 'STRONG_PLAYER' : 'CHALLENGER'}
                        </div>
                        <div class="col-6">
                            <strong>Defensibility:</strong> ${overallMoat > 80 ? 'HIGH' : overallMoat > 65 ? 'MEDIUM' : 'LOW'}<br>
                            <strong>Sustainability:</strong> ${overallMoat > 85 ? '5+ years' : overallMoat > 70 ? '3-5 years' : '1-3 years'}
                        </div>
                    </div>
                    <div class="mt-2">
                        <h6>Top Strengths:</h6>
                        <ul class="small">
                            <li>Proprietary AI algorithms and data network effects</li>
                            <li>Comprehensive regulatory compliance framework</li>
                            <li>High switching costs through deep integration</li>
                        </ul>
                    </div>
                </div>
            `;

            // Update moat chart
            const ctx = document.getElementById('moatChart').getContext('2d');
            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(factors),
                    datasets: [{
                        label: 'Moat Strength',
                        data: Object.values(factors),
                        backgroundColor: 'rgba(54, 162, 235, 0.8)',
                        borderColor: 'rgba(54, 162, 235, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        y: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        // Auto-load real data on page load
        window.onload = function() {
            getInventoryStatus();
            getForecast();
        };
    </script>
</body>
</html>
