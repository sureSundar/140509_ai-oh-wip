FRAUDGUARD AI â€” COMPLETE HACKATHON SUBMISSION
=============================================

ğŸ† REALâ€‘TIME BANKING FRAUD DETECTION MVP (Problem 03)
Team: 140509_03 | Theme: AI for Industry (Financial Services)

ğŸ¯ EXECUTIVE SUMMARY
--------------------
FraudGuard AI is a realâ€‘time fraud detection MVP for banking payments that combines an efficient ML ensemble with a rule engine and rolling behavioral features to deliver subâ€‘100ms risk decisions. The MVP exposes a clean ingestion API, a rule management surface, metrics, and optional PostgreSQL persistence. It demonstrates how to balance MLâ€‘based anomaly detection with explainable, auditable rules that fraud analysts can tune live.

âœ… KEY CAPABILITIES
-------------------
â€¢ Realâ€‘time decisioning API with perâ€‘request explanations (ML + rules + features)
â€¢ Lightweight ML ensemble (heuristics for RF/IF/NN/XGB) suitable for demo speed and clarity
â€¢ Rule engine with live CRUD and metrics; YAMLâ€‘backed with safe expression evaluation
â€¢ Rolling feature store (velocity/amounts) with optional Redis backend
â€¢ Optional Postgres persistence of transactions/decisions + recent decisions endpoint
â€¢ Prometheus metrics and health probes for observability

ğŸš€ ARCHITECTURE OVERVIEW
------------------------

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Ingestion API (FastAPI, :8000)                                            â”‚
â”‚  â€¢ POST /api/v1/transactions â†’ Decision (APPROVE/REVIEW/DECLINE)          â”‚
â”‚  â€¢ GET  /decisions/recent  â†’ Last decisions (DB or inâ€‘memory cache)       â”‚
â”‚  â€¢ GET  /rules (+CRUD, metrics) â†’ Live rules management                    â”‚
â”‚  â€¢ GET  /metrics, /healthz, /stats/summary, /demo (static)                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                â”‚                               â”‚
        Feature Store                     Decision Service
  (InMemory or Redis)                   (ML Ensemble + Rules)
   â€¢ Velocity score 1h                  â€¢ Weighted ML probability (0..1)
   â€¢ 7â€‘day avg/std amount               â€¢ Rule engine score (0..200)
                                        â€¢ Composite risk (0..1000)

Optional persistence: PostgreSQL (:5432)
â€¢ Upserts transactions + decisions; query recent decisions

ğŸ§  DECISIONING LOGIC
--------------------
1) Feature extraction (rolling aggregates per customer)
2) ML ensemble (heuristics for RF/IF/NN/XGB) over normalized signals â†’ prob 0..1
3) Rules engine (YAML rules over features, e.g., z_score â‰¥ 3, velocity â‰¥ 10) â†’ points
4) Composite risk: int(prob*800) + rule_points (capped at 1000)
5) Thresholds (configurable): â‰¤350 APPROVE, â‰¥700 DECLINE, else REVIEW
6) Explanation payload includes perâ€‘model scores, rule flags, features

ğŸ“¦ REPO LAYOUT (src/)
---------------------
â€¢ ingestion_service/main.py    â€” FastAPI app, endpoints, static demo
â€¢ decision_service/service.py  â€” Feature store (inâ€‘mem/Redis), ensemble, rule engine, thresholds
â€¢ ml_serving/service.py        â€” Heuristic ensemble (RF/IF/NN/XGBâ€‘like)
â€¢ rule_engine/engine.py        â€” YAML rules loader + CRUD + metrics, safe eval of expressions
â€¢ feature_store/service.py     â€” Rolling aggregates (velocity, 7â€‘day avg/std amount)
â€¢ common/models.py             â€” Pydantic models (TransactionRequest, DecisionResponse, enums)
â€¢ common/config.py             â€” Weights and decision thresholds
â€¢ persistence/models.py        â€” SQLAlchemy ORM models
â€¢ persistence/repository.py    â€” Upsert/query helpers; create tables
â€¢ requirements.txt             â€” FastAPI, SQLAlchemy, psycopg2, alembic, redis client, metrics

ğŸ”Œ API SURFACE (Judgeâ€‘Friendly)
-------------------------------
Base: http://localhost:8000

Health & Metrics
â€¢ GET /healthz             â†’ {status, db, uptimeSec, version}
â€¢ GET /metrics             â†’ Prometheus exposition
â€¢ GET /stats/summary       â†’ {totalRecent, byDecision}

Decisioning
â€¢ POST /api/v1/transactions (TransactionRequest)
  â†’ DecisionResponse {decision, riskScore, explanation{ml, rules, features}, processingMs}
â€¢ GET  /decisions/recent?limit=20 (DB if enabled; fallback to inâ€‘memory recent cache)

Rules (live tuning)
â€¢ GET    /rules                      â†’ {version, rules{aml|fraud:[{name,condition,points}]}}
â€¢ POST   /rules                      â†’ add rule {category, name, condition, points}
â€¢ PUT    /rules/{category}/{name}    â†’ update rule condition/points
â€¢ DELETE /rules/{category}/{name}    â†’ remove rule
â€¢ GET    /rules/metrics              â†’ perâ€‘rule hit counts
â€¢ POST   /rules/metrics/reset        â†’ clear metrics

ğŸ§ª CURL EXAMPLES
----------------
1) Health
  curl -s localhost:8000/healthz | jq

2) Decision (APPROVE/REVIEW/DECLINE with explanation)
  curl -s -X POST localhost:8000/api/v1/transactions \
    -H 'Content-Type: application/json' \
    -d '{
      "customerId": "CUST_001",
      "amount": 129.99,
      "currency": "USD",
      "merchantId": "M0001",
      "timestamp": "2025-08-30T12:00:00Z",
      "channel": "CARD",
      "location": {"latitude":40.7,"longitude":-74.0,"country":"US","city":"NYC"},
      "deviceFingerprint": "dev-abc123"
    }' | jq

3) Rules â€” add a highâ€‘velocity fraud rule
  curl -s -X POST localhost:8000/rules -H 'Content-Type: application/json' \
    -d '{"category":"fraud","name":"HighVelocity","condition":"velocity_score_1h>=10","points":40}' | jq

4) Recent decisions (DB or cache)
  curl -s localhost:8000/decisions/recent | jq

ğŸ“Š OBSERVABILITY
----------------
â€¢ Prometheus metrics at /metrics (http_requests_total, latency_seconds, decisions_total)
â€¢ Healthz shows API uptime and DB connectivity

ğŸ—„ï¸ PERSISTENCE (Optional, via dockerâ€‘compose)
--------------------------------------------
â€¢ Postgres 15 (:5432), volumeâ€‘backed
â€¢ Set env DATABASE_URL=postgresql://fraud:fraud@db:5432/fraud to enable persistence
â€¢ Repository ensures idempotent table creation and upsert logic; recent decisions endpoint joins decision + transaction data

ğŸš¢ RUN & DEMO (Oneâ€‘Click)
-------------------------
Using Docker Compose:
1) cd 140509_03
2) docker compose up --build -d
3) Open:
   - API Health:   http://localhost:8000/healthz
   - Demo UI:      http://localhost:8000/demo/
   - Metrics:      http://localhost:8000/metrics
   - Recent:       http://localhost:8000/decisions/recent

Local dev:
â€¢ uvicorn ingestion_service.main:app --reload --app-dir 140509_03/src

ğŸ”’ EXPLAINABILITY & COMPLIANCE
------------------------------
â€¢ Perâ€‘decision explanation details ML components, rule flags, and feature values
â€¢ Rules are auditable and editable via CRUD endpoints; changes tracked by version
â€¢ Safe evaluation of rule conditions (restricted context) for MVP; can be replaced by a DSL in production

ğŸ“ˆ ROADMAP (Beyond MVP)
-----------------------
â€¢ Replace heuristic ensemble with trained RF/XGB/NN pipelines (same interface)
â€¢ Kafka ingestion + Flink/Spark streaming features at high TPS
â€¢ Full Redis feature store for crossâ€‘instance sharing
â€¢ Advanced rules DSL with versioning, A/B tests, and performance analytics
â€¢ Model monitoring (drift, PSI), canary deployments, automated retraining
â€¢ Analyst console (case management, feedback loops) and alerting workflows

ğŸ¤ JUDGE EXPERIENCE CHECKLIST
-----------------------------
â€¢ Endâ€‘toâ€‘end run: POST transaction â†’ decision, score, explanation under ~100ms
â€¢ Live rules tuning: add/update/delete a rule and observe decision changes
â€¢ Observability: metrics + healthz visible; recent decisions list populates
â€¢ Persistence: enable DATABASE_URL and verify decisions persisted in Postgres
â€¢ Explainability: ML perâ€‘model scores + rule flags visible per decision

â€” End of FraudGuard AI MVP Submission â€”

